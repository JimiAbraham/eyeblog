/**
 * @name string-strip-html
 * @fileoverview Strips HTML tags from strings. No parser, accepts mixed sources.
 * @version 11.0.1
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-strip-html/}
 */

import P from"lodash.isplainobject";import Z from"lodash.trim";import ie from"lodash.without";import{decode as X}from"html-entities";import{rApply as oe}from"ranges-apply";import{Ranges as re}from"ranges-push";import{right as V}from"string-left-right";function z(t){return/[-_A-Za-z0-9]/.test(t)}function x(t,c){if(!t)return[];if(Array.isArray(t))return t.filter(y=>typeof y=="string"&&y.trim());if(typeof t=="string")return t.trim()?[t]:[];throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_03] ${c} must be array containing zero or more strings or something falsey. Currently it's equal to: ${t}, that a type of ${typeof t}.`)}function se(t,c,y,b){for(let f=c,p=t.length;f<p;f++){if(t.startsWith(y,f))return!0;if(t.startsWith(b,f))return!1}return!1}function U(t,c,y){return!t||!t.quotes||!se(c,y+1,t.quotes.value,">")}var R=new Set(["!doctype","abbr","address","area","article","aside","audio","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","doctype","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","param","picture","pre","progress","rb","rp","rt","rtc","ruby","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","ul","var","video","wbr","xml"]),H=new Set(["a","b","i","p","q","s","u"]),_=new Set([".",",","?",";",")","\u2026",'"',"\xBB"]),K=new Set(["a","abbr","acronym","audio","b","bdi","bdo","big","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"]);var Q="11.0.1";var Se=Q,v={ignoreTags:[],ignoreTagsWithTheirContents:[],onlyStripTags:[],stripTogetherWithTheirContents:["script","style","xml"],skipHtmlDecoding:!1,trimOnlySpaces:!1,stripRecognisedHTMLOnly:!1,dumpLinkHrefsNearby:{enabled:!1,putOnNewLine:!1,wrapHeads:"",wrapTails:""},cb:null};function ue(t,c){let y=Date.now(),b=[],f=[],p=[],m=[],n={};function ee(){n={attributes:[]}}ee();let T=null,L=null,l={},d={tagName:"",hrefValue:"",openingTagEnds:void 0},E="",W=!1,N=null,w=!0;function ne(e){return e!=null}function te(e){return typeof e=="string"}function J(e,o,a){if(Array.isArray(o.stripTogetherWithTheirContents)&&(o.stripTogetherWithTheirContents.includes(n.name)||o.stripTogetherWithTheirContents.includes("*")))if(n.slashPresent&&Array.isArray(b)&&b.some(i=>i.name===n.name)){for(let i=b.length;i--;)if(b[i].name===n.name){m=m.filter(([g,$])=>(g<b[i].lastOpeningBracketAt||g>=e+1)&&($<=b[i].lastOpeningBracketAt||$>e+1));let r=e+1;n.lastClosingBracketAt&&(r=n.lastClosingBracketAt+1),m.push([b[i].lastOpeningBracketAt,r]),_.has(t[e])&&o.cb?o.cb({tag:n,deleteFrom:b[i].lastOpeningBracketAt,deleteTo:e+1,insert:null,rangesArr:a,proposedReturn:[b[i].lastOpeningBracketAt,e,null]}):o.cb&&o.cb({tag:n,deleteFrom:b[i].lastOpeningBracketAt,deleteTo:e,insert:"",rangesArr:a,proposedReturn:[b[i].lastOpeningBracketAt,e,""]}),b.splice(i,1);break}}else n.slashPresent||b.push(n);else Array.isArray(o.ignoreTagsWithTheirContents)&&F(e,o,n)&&(w=!1)}function B(e,o,a,i,r,g){if(Array.isArray(u.current())&&typeof a=="number"&&u.current()[0][0]===0&&u.current()[0][1]>=a)return"";if(t.length===i&&g)return null;let $="";if(Number.isInteger(a)&&a<r&&($+=e.slice(a,r)),Number.isInteger(i)&&i>g+1){let k=e.slice(g+1,i);k.includes(`
`)&&O(i,e)?$+=" ":$+=k}let A=!_.has(e[o]),G=e[i-1]!==">"||!e[a].trim(),Y=!['"',"("].includes(e[r-1]),le=![";",".",":","!"].includes(e[o]);if((A||G&&Y&&le)&&(G||Y)&&e[o]!=="!"&&(!K.has(n.name)||typeof a=="number"&&a<r||typeof i=="number"&&i>g+1)){let k=$.match(/\n/g);return Array.isArray(k)&&k.length?k.length===1?`
`:k.length===2?`

`:`


`:" "}return""}function j(e){if(e.dumpLinkHrefsNearby.enabled&&d.tagName&&d.tagName===n.name&&n.lastOpeningBracketAt&&(d.openingTagEnds&&n.lastOpeningBracketAt>d.openingTagEnds||!d.openingTagEnds)&&(W=!0),W){let o=e.dumpLinkHrefsNearby.putOnNewLine?`

`:"";E=`${o}${d.hrefValue}${o}`}}function O(e,o){return o?o[e]==="<"&&o[e+1]!=="%":t[e]==="<"&&t[e+1]!=="%"}function S(e){return t[e]===">"&&t[e-1]!=="%"}function F(e,o,a){if(o.ignoreTagsWithTheirContents.includes("*"))return!0;let i=t.indexOf(`<${a.name}`,e),r=t.indexOf(`</${a.name}`,e);return!a.slashPresent&&r===-1||a.slashPresent&&!f.some(g=>g.name===a.name)||r>-1&&i>-1&&i<r?!1:o.ignoreTagsWithTheirContents.includes(a.name)}if(typeof t!="string")throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_01] Input must be string! Currently it's: ${(typeof t).toLowerCase()}, equal to:
${JSON.stringify(t,null,4)}`);if(c&&!P(c))throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_02] Optional Options Object must be a plain object! Currently it's: ${(typeof c).toLowerCase()}, equal to:
${JSON.stringify(c,null,4)}`);function q(){W&&(d={tagName:"",hrefValue:"",openingTagEnds:void 0},W=!1)}let s={...v,...c};if(Object.prototype.hasOwnProperty.call(s,"returnRangesOnly"))throw new TypeError("string-strip-html/stripHtml(): [THROW_ID_03] resolvedOpts.returnRangesOnly has been removed from the API since v.5 release.");s.ignoreTags=x(s.ignoreTags,"resolvedOpts.ignoreTags"),s.onlyStripTags=x(s.onlyStripTags,"resolvedOpts.onlyStripTags");let M=!!s.onlyStripTags.length;if(s.onlyStripTags.length&&s.ignoreTags.length&&(s.onlyStripTags=ie(s.onlyStripTags,...s.ignoreTags)),P(s.dumpLinkHrefsNearby)||(s.dumpLinkHrefsNearby={...v.dumpLinkHrefsNearby}),s.dumpLinkHrefsNearby=v.dumpLinkHrefsNearby,c&&Object.prototype.hasOwnProperty.call(c,"dumpLinkHrefsNearby")&&ne(c.dumpLinkHrefsNearby)){if(P(c.dumpLinkHrefsNearby))s.dumpLinkHrefsNearby={...v.dumpLinkHrefsNearby,...c.dumpLinkHrefsNearby};else if(c.dumpLinkHrefsNearby)throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_04] Optional Options Object's key dumpLinkHrefsNearby was set to ${typeof c.dumpLinkHrefsNearby}, equal to ${JSON.stringify(c.dumpLinkHrefsNearby,null,4)}. The only allowed value is a plain object. See the API reference.`)}s.stripTogetherWithTheirContents?typeof s.stripTogetherWithTheirContents=="string"&&s.stripTogetherWithTheirContents.length&&(s.stripTogetherWithTheirContents=[s.stripTogetherWithTheirContents]):s.stripTogetherWithTheirContents=[];let I={};if(s.stripTogetherWithTheirContents&&Array.isArray(s.stripTogetherWithTheirContents)&&s.stripTogetherWithTheirContents.length&&!s.stripTogetherWithTheirContents.every((e,o)=>typeof e!="string"?(I.el=e,I.i=o,!1):!0))throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_05] Optional Options Object's key stripTogetherWithTheirContents was set to contain not just string elements! For example, element at index ${I.i} has a value ${I.el} which is not string but ${(typeof I.el).toLowerCase()}.`);s.cb||(s.cb=({rangesArr:e,proposedReturn:o})=>{o&&e.push(...o)});let u=new re({limitToBeAddedWhitespace:!0,limitLinebreaksCount:2});if(!s.skipHtmlDecoding)for(;t!==X(t,{scope:"strict"});)t=X(t,{scope:"strict"});let C=!1,D=!1;for(let e=0,o=t.length;e<o;e++){if(Object.keys(n).length>1&&n.lastClosingBracketAt&&n.lastClosingBracketAt<e&&t[e]!==" "&&N===null&&(N=e),!C&&t[e]==="%"&&t[e-1]==="{"&&t.includes("%}",e+1)){let a=t.indexOf("%}",e)-1;if(a>e){e=a;continue}}if(!C&&S(e)&&(!n||Object.keys(n).length<2)&&e>1){for(let a=e;a--;)if(t[a-1]===void 0||S(a)){let i=t[a-1]===void 0?a:a+1,r=t.slice(i,e+1);if(t!==`<${Z(r.trim(),"/>")}>`&&[...R].some(g=>Z(r.trim().split(/\s+/).filter($=>$.trim()).filter(($,A)=>A===0),"/>").toLowerCase()===g)&&ue(`<${r.trim()}>`,s).result===""){(!p.length||p[p.length-1][0]!==n.lastOpeningBracketAt)&&p.push([i,e+1]),(!m.length||m[m.length-1][0]!==n.lastOpeningBracketAt)&&m.push([i,e+1]);let g=B(t,e,i,e+1,i,e+1),$=e+1;if(t[$]&&!t[$].trim()){for(let A=$;A<o;A++)if(t[A].trim()){$=A;break}}s.cb({tag:n,deleteFrom:i,deleteTo:$,insert:g,rangesArr:u,proposedReturn:[i,$,g]})}break}}if(!D&&t[e]==="/"&&!n.quotes?.value&&Number.isInteger(n.lastOpeningBracketAt)&&!Number.isInteger(n.lastClosingBracketAt)&&(n.slashPresent=e),t[e]==='"'||t[e]==="'")if(!D&&n.nameStarts&&n.quotes&&n.quotes.value&&n.quotes.value===t[e]){l.valueEnds=e,l.value=t.slice(l.valueStarts,e),n.attributes.push(l),l={},delete n.quotes;let a;s.dumpLinkHrefsNearby.enabled&&n.attributes.some(i=>{if(typeof i.name=="string"&&i.name.toLowerCase()==="href")return a=`${s.dumpLinkHrefsNearby.wrapHeads||""}${i.value}${s.dumpLinkHrefsNearby.wrapTails||""}`,!0})&&(d={tagName:n.name,hrefValue:a,openingTagEnds:void 0})}else!D&&!n.quotes&&n.nameStarts&&(n.quotes={},n.quotes.value=t[e],n.quotes.start=e,l.nameStarts&&l.nameEnds&&l.nameEnds<e&&l.nameStarts<e&&!l.valueStarts&&(l.name=t.slice(l.nameStarts,l.nameEnds)));if(n.nameStarts!==void 0&&n.nameEnds===void 0&&(!t[e].trim()||!z(t[e]))){if(n.nameEnds=e,n.name=t.slice(n.nameStarts,n.nameEnds+(!S(e)&&t[e]!=="/"&&t[e+1]===void 0?1:0)),t[n.nameStarts-1]!=="!"&&!n.name.replace(/-/g,"").length||/^\d+$/.test(n.name[0])){n={};continue}if(typeof n.name=="string"&&n.name.toLowerCase()==="doctype"&&(D=!0),O(e)){j(s);let a=B(t,e,n.leftOuterWhitespace,e,n.lastOpeningBracketAt,e);(s.stripTogetherWithTheirContents.includes(n.name)||s.stripTogetherWithTheirContents.includes("*"))&&(m=m.filter(([i,r])=>!(i===n.leftOuterWhitespace&&r===e))),s.cb({tag:n,deleteFrom:n.leftOuterWhitespace,deleteTo:e,insert:`${a}${E}${a}`,rangesArr:u,proposedReturn:[n.leftOuterWhitespace,e,`${a}${E}${a}`]}),q(),J(e,s,u)}}if(n.quotes?.start&&n.quotes.start<e&&!n.quotes.end&&l.nameEnds&&l.equalsAt&&!l.valueStarts&&(l.valueStarts=e),!n.quotes&&l.nameEnds&&t[e]==="="&&!l.valueStarts&&!l.equalsAt&&(l.equalsAt=e),!n.quotes&&l.nameStarts&&l.nameEnds&&!l.valueStarts&&t[e].trim()&&t[e]!=="="&&(n.attributes.push(l),l={}),!n.quotes&&l.nameStarts&&!l.nameEnds&&(D&&`'"`.includes(t[l.nameStarts])?l.nameStarts<e&&t[e]===t[l.nameStarts]&&(l.nameEnds=e+1,l.name=t.slice(l.nameStarts,l.nameEnds)):t[e].trim()?t[e]==="="?l.equalsAt||(l.nameEnds=e,l.equalsAt=e,l.name=t.slice(l.nameStarts,l.nameEnds)):t[e]==="/"||S(e)?(l.nameEnds=e,l.name=t.slice(l.nameStarts,l.nameEnds),n.attributes.push(l),l={}):O(e)&&(l.nameEnds=e,l.name=t.slice(l.nameStarts,l.nameEnds),n.attributes.push(l),l={}):(l.nameEnds=e,l.name=t.slice(l.nameStarts,l.nameEnds))),!n.quotes&&n.nameEnds<e&&!t[e-1].trim()&&t[e].trim()&&!"<>/!".includes(t[e])&&!l.nameStarts&&!n.lastClosingBracketAt&&(l.nameStarts=e),n.lastOpeningBracketAt!==null&&n.lastOpeningBracketAt<e&&t[e]==="/"&&n.onlyPlausible&&(n.onlyPlausible=!1),n.lastOpeningBracketAt!==null&&n.lastOpeningBracketAt<e&&t[e]!=="/"&&(n.onlyPlausible===void 0&&((!t[e].trim()||O(e))&&!n.slashPresent?n.onlyPlausible=!0:n.onlyPlausible=!1),t[e].trim()&&n.nameStarts===void 0&&!O(e)&&t[e]!=="/"&&!S(e)&&t[e]!=="!"&&(n.nameStarts=e,n.nameContainsLetters=!1)),n.nameStarts&&!n.quotes&&typeof t[e]=="string"&&t[e].toLowerCase()!==t[e].toUpperCase()&&(n.nameContainsLetters=!0),S(e)&&U(n,t,e)&&!0&&n.lastOpeningBracketAt!==void 0&&(n.lastClosingBracketAt=e,N=null,Object.keys(l).length&&(n.attributes.push(l),l={}),s.dumpLinkHrefsNearby.enabled&&d.tagName&&!d.openingTagEnds&&(d.openingTagEnds=e)),(!D||t[e]===">")&&n.lastOpeningBracketAt!==void 0){if(n.lastClosingBracketAt===void 0){if(n.lastOpeningBracketAt<e&&!O(e)&&(t[e+1]===void 0||O(e+1))&&n.nameContainsLetters&&typeof n.nameStarts=="number"){if(n.name=t.slice(n.nameStarts,n.nameEnds||e+1).toLowerCase(),(!p.length||p[p.length-1][0]!==n.lastOpeningBracketAt)&&p.push([n.lastOpeningBracketAt,e+1]),s.ignoreTags.includes(n.name)||F(e,s,n)||!R.has(n.name)&&(n.onlyPlausible||s.stripRecognisedHTMLOnly)){n={},l={};continue}if((R.has(n.name)||H.has(n.name))&&(n.onlyPlausible===!1||n.onlyPlausible===!0&&n.attributes.length)||t[e+1]===void 0){j(s);let a=B(t,e,n.leftOuterWhitespace,e+1,n.lastOpeningBracketAt,n.lastClosingBracketAt);C&&n.name==="script"&&n.slashPresent&&(C=!1);let i;a===null||E===null?i=null:i=`${a}${E}${a}`,s.cb({tag:n,deleteFrom:n.leftOuterWhitespace,deleteTo:e+1,insert:i,rangesArr:u,proposedReturn:[n.leftOuterWhitespace,e+1,i]}),q(),J(e,s,u)}if(!m.length||m[m.length-1][0]!==n.lastOpeningBracketAt&&m[m.length-1][1]!==e+1)if(s.stripTogetherWithTheirContents.includes(n.name)||s.stripTogetherWithTheirContents.includes("*")){let a;for(let i=b.length;i--;)b[i].name===n.name&&(a=b[i]);a?(m=m.filter(([i])=>i!==a.lastOpeningBracketAt),m.push([a.lastOpeningBracketAt,e+1])):m.push([n.lastOpeningBracketAt,e+1])}else m.push([n.lastOpeningBracketAt,e+1])}}else if(e>n.lastClosingBracketAt&&t[e].trim()||t[e+1]===void 0){let a=n.lastClosingBracketAt===e?e+1:e;s.trimOnlySpaces&&a===o-1&&N!==null&&N<e&&(a=N),(!p.length||p[p.length-1][0]!==n.lastOpeningBracketAt)&&p.push([n.lastOpeningBracketAt,n.lastClosingBracketAt+1]);let i=s.ignoreTags.includes(n.name),r=F(e,s,n);if(!w||s.stripRecognisedHTMLOnly&&typeof n.name=="string"&&!R.has(n.name.toLowerCase())&&!H.has(n.name.toLowerCase())||!M&&(i||r)||M&&!s.onlyStripTags.includes(n.name)){if(r)if(n.slashPresent){for(let g=f.length;g--;)if(f[g].name===n.name){f.splice(g,1);break}f.length||(w=!0)}else w&&(w=!1),f.push(n);s.cb({tag:n,deleteFrom:null,deleteTo:null,insert:null,rangesArr:u,proposedReturn:null}),n={},l={}}else if(!n.onlyPlausible||n.attributes.length===0&&n.name&&(R.has(n.name.toLowerCase())||H.has(n.name.toLowerCase()))||n.attributes?.some(g=>g.equalsAt)){(!m.length||m[m.length-1][0]!==n.lastOpeningBracketAt)&&m.push([n.lastOpeningBracketAt,n.lastClosingBracketAt+1]);let g=B(t,e,n.leftOuterWhitespace,a,n.lastOpeningBracketAt,n.lastClosingBracketAt);E="",W=!1,j(s);let $;te(E)&&E.length?($=`${g}${E}${g===`

`?`
`:g}`,a===n.lastClosingBracketAt+1&&($+=" "),n.leftOuterWhitespace===n.lastOpeningBracketAt&&u.last()&&u.last()[1]<n.lastOpeningBracketAt&&($=" "+$)):$=g,$!==null&&(n.leftOuterWhitespace===0||!V(t,a-1))&&($=void 0),s.cb({tag:n,deleteFrom:n.leftOuterWhitespace,deleteTo:a,insert:$,rangesArr:u,proposedReturn:[n.leftOuterWhitespace,a,$]}),q(),J(e,s,u)}else n={};S(e)||(n={})}D&&(D=!1)}if((!C||t[e]==="<"&&V(t,V(t,e))&&t[V(t,e)]==="/"&&t.startsWith("script",V(t,V(t,e))))&&O(e)&&!O(e-1)&&!`'"`.includes(t[e+1])&&(!`'"`.includes(t[e+2])||/\w/.test(t[e+1]))&&!(t[e+1]==="c"&&t[e+2]===":")&&!(t[e+1]==="f"&&t[e+2]==="m"&&t[e+3]==="t"&&t[e+4]===":")&&!(t[e+1]==="s"&&t[e+2]==="q"&&t[e+3]==="l"&&t[e+4]===":")&&!(t[e+1]==="x"&&t[e+2]===":")&&!(t[e+1]==="f"&&t[e+2]==="n"&&t[e+3]===":")&&U(n,t,e)){if(S(V(t,e)))continue;if(n.nameEnds&&n.nameEnds<e&&!n.lastClosingBracketAt&&(n.onlyPlausible===!0&&n.attributes&&n.attributes.length||n.onlyPlausible===!1)){let a=B(t,e,n.leftOuterWhitespace,e,n.lastOpeningBracketAt,e);s.cb({tag:n,deleteFrom:n.leftOuterWhitespace,deleteTo:e,insert:a,rangesArr:u,proposedReturn:[n.leftOuterWhitespace,e,a]}),J(e,s,u),n={},l={}}if(n.lastOpeningBracketAt!==void 0&&n.onlyPlausible&&n.name&&!n.quotes&&(n.lastOpeningBracketAt=void 0,n.name=void 0,n.onlyPlausible=!1),(n.lastOpeningBracketAt===void 0||!n.onlyPlausible)&&!n.quotes&&(n.lastOpeningBracketAt=e,n.slashPresent=!1,n.attributes=[],T===null?n.leftOuterWhitespace=e:s.trimOnlySpaces&&T===0?n.leftOuterWhitespace=L||e:n.leftOuterWhitespace=T,`${t[e+1]}${t[e+2]}${t[e+3]}`=="!--"||`${t[e+1]}${t[e+2]}${t[e+3]}${t[e+4]}${t[e+5]}${t[e+6]}${t[e+7]}${t[e+8]}`=="![CDATA[")){let a=!0;t[e+2]==="-"&&(a=!1);let i;for(let r=e;r<o;r++)if((!i&&a&&`${t[r-2]}${t[r-1]}${t[r]}`=="]]>"||!a&&`${t[r-2]}${t[r-1]}${t[r]}`=="-->")&&(i=r),i&&(i<r&&t[r].trim()||t[r+1]===void 0)){let g=r;(t[r+1]===void 0&&!t[r].trim()||t[r]===">")&&(g+=1),(!p.length||p[p.length-1][0]!==n.lastOpeningBracketAt)&&p.push([n.lastOpeningBracketAt,i+1]),(!m.length||m[m.length-1][0]!==n.lastOpeningBracketAt)&&m.push([n.lastOpeningBracketAt,i+1]);let $=B(t,r,n.leftOuterWhitespace,g,n.lastOpeningBracketAt,i);s.cb({tag:n,deleteFrom:n.leftOuterWhitespace,deleteTo:g,insert:$,rangesArr:u,proposedReturn:[n.leftOuterWhitespace,g,$]}),e=r-1,t[r]===">"&&(e=r),n={},l={};break}}}t[e].trim()?T!==null&&(!n.quotes&&l.equalsAt>T-1&&l.nameEnds&&l.equalsAt>l.nameEnds&&t[e]!=='"'&&t[e]!=="'"&&(P(l)&&n.attributes.push(l),l={},n.equalsSpottedAt=void 0),T=null):T===null&&(T=e,n.lastOpeningBracketAt!==void 0&&n.lastOpeningBracketAt<e&&n.nameStarts&&n.nameStarts<n.lastOpeningBracketAt&&e===n.lastOpeningBracketAt+1&&!b.some(a=>a.name===n.name)&&(n.onlyPlausible=!0,n.name=void 0,n.nameStarts=void 0)),t[e]===" "?L===null&&(L=e):L!==null&&(L=null),n.name==="script"&&(C=!n.slashPresent)}if(t&&(s.trimOnlySpaces&&t[0]===" "||!s.trimOnlySpaces&&!t[0].trim()))for(let e=0,o=t.length;e<o;e++)if(s.trimOnlySpaces&&t[e]!==" "||!s.trimOnlySpaces&&t[e].trim()){u.push([0,e]);break}else t[e+1]||u.push([0,e+1]);if(t&&(s.trimOnlySpaces&&t[t.length-1]===" "||!s.trimOnlySpaces&&!t[t.length-1].trim())){for(let e=t.length;e--;)if(s.trimOnlySpaces&&t[e]!==" "||!s.trimOnlySpaces&&t[e].trim()){u.push([e+1,t.length]);break}}let h=u.current();if((!c||!c.cb)&&h){if(h[0]&&!h[0][0]){let e=h[0][1];u.ranges[0]=[u.ranges[0][0],u.ranges[0][1]]}if(h[h.length-1]&&h[h.length-1][1]===t.length){let e=h[h.length-1][0];if(u.ranges){let o=u.ranges[u.ranges.length-1][0];t[o-1]&&(s.trimOnlySpaces&&t[o-1]===" "||!s.trimOnlySpaces&&!t[o-1].trim())&&(o-=1);let a=u.ranges[u.ranges.length-1][2];u.ranges[u.ranges.length-1]=[o,u.ranges[u.ranges.length-1][1]],a?.trim()&&u.ranges[u.ranges.length-1].push(a.trimEnd())}}}return{log:{timeTakenInMilliseconds:Date.now()-y},result:oe(t,u.current()),ranges:u.current(),allTagLocations:p,filteredTagLocations:m}}export{v as defaults,ue as stripHtml,Se as version};
